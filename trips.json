---
---
{
  "destinations": [
  {% for country in site.posts %}
    { "id": "{{ country.title | slugify }}", "name": "{{ country.title }}" }{% unless forloop.last %},{% endunless %}
  {% endfor %}
  ],
  "trips": [
  {% for trip in site.categories %}
    {
      {% assign trip_id = trip | first %}
      {% assign trip_data = site.data.trips | where: 'id',trip_id | first %}
      "name": "{{ trip_data.name }}",
      "id": "{{ trip_id }}",
      "date": {
        {% if trip_data.date.start %}
          "start": "{{ trip_data.date.start }}"
        {% endif %}{% if trip_data.date.end %},
          "end": "{{ trip_data.date.end }}"
        {% endif %}
      },
      "geojson": "dist/{{ trip_id }}.geojson",
      "destinations": [
      {% for destination in trip[1] %}
        {
          "name": "{{ destination.title }}",
          "dates": [
          {% for date in destination.dates %}
            {
              "start": "{{ date.start }}",
              "end": "{{ date.end }}"
            }{% unless forloop.last %},{% endunless %}
          {% endfor %}
          ],
          "expenditures": [
          {% for expenditure in destination.expenditures %}
            {
              "name": "{{ expenditure[0] }}",
              "amount": "{{ expenditure[1] }}"
            }{% unless forloop.last %},{% endunless %}
          {% endfor %}
          ]
        }{% unless forloop.last %},{% endunless %}
      {% endfor %}
      ]
    }{% unless forloop.last %},{% endunless %}
  {% endfor %}
  ]
}
