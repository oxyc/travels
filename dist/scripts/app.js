(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{0:function(t,e,a){a("bYYy"),a("6uIU"),t.exports=a("4NqL")},"4NqL":function(t,e){},"6uIU":function(t,e){},bYYy:function(t,e,a){"use strict";a.r(e);var r=a("LvDl"),n=a.n(r),o=a("4R65"),i=a.n(o),c=a("0hfp");a("JXP8"),a("qmF3"),a("k8be");i.a.Icon.Default.imagePath="/dist/images",i.a.mapbox=i.a.mapbox||{},i.a.mapbox.accessToken="pk.eyJ1Ijoib3h5IiwiYSI6InBMaXRxSDAifQ.w9NqRLivEBn6BoMRkKmg3A",i.a.MakiMarkers.accessToken=i.a.mapbox.accessToken;var u,l,s=(u="world-map",l=i.a.map(u,{center:[18,0],zoom:2,minZoom:2,maxZoom:10,scrollWheelZoom:!1}),i.a.tileLayer("https://api.mapbox.com/v4/{id}/{z}/{x}/{y}"+(i.a.Browser.retina?"@2x":"")+".png?access_token={accessToken}",{attribution:'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',maxZoom:18,id:"oxy.ndp8318l",accessToken:i.a.mapbox.accessToken}).addTo(l),l),p=i.a.markerClusterGroup({maxClusterRadius:20}).addTo(s),y={},d={trek:{icon:"campsite",color:"#159957"},city:{icon:"circle",color:"#659CD6"},park:{icon:"park",color:"#159957"},homebase:{icon:"building",color:"#D85E5E"},photo:{icon:"camera",color:"#659CD6",size:"s"},visited:{color:"#659CD6"}},f={trek:{color:"#159957",opacity:1,weight:5},route:{color:"#000",opacity:1,weight:2},tour:{color:"#000",opacity:1,weight:2},flight:{color:"#000",opacity:.3,weight:2},boat:{color:"#2057D0",opacity:.3,weight:2},mouseover:{color:"#ff0000",opacity:.7,weight:3}},m=document.querySelector("#world-map"),v=n.a.reject(m.dataset.trips.split(" ")||[],n.a.isEmpty),h=n.a.reject(m.dataset.country.split(" ")||[],n.a.isEmpty),g={};fetch("/world.json").then((function(t){return t.json()})).then((function(t){var e=n.a.forEach(t.trips,(function(t){t.promise=fetch("/".concat(t.path))}));s.once("zoomstart",(function(){m.style.backgroundImage="none"})),s.on("overlayadd overlayremove",n.a.debounce((function(t){if(t.layer.type&&"country"===t.layer.type){var e=p.getLayers();if(0===e.length)return;for(var a=new i.a.LatLngBounds,r=0,n=e.length;r<n;r++)a.extend(e[r].getLatLng());s.fitBounds(a)}}),100)),function(t){var e=D("country",t=t.sort((function(t,e){return t.properties.id<e.properties.id?-1:t.properties.id>e.properties.id?1:0})),{onEachFeature:w,pointToLayer:x}),a={};n.a.forEach(e,(function(t,e){a[e]=i.a.layerGroup(),a[e].type="country",a[e].id=t.id,h.length>0&&!h.includes(t.id)||(a[e].addTo(s),p.addLayer(t))}));var r=L("country",a);for(var o in y.country=r,r._layers)r._layers[o]&&(g[i.a.Util.stamp(r._layers[o].layer)]=r._layers[o].name);s.on("overlayadd overlayremove",(function(t){var a=g[i.a.Util.stamp(t.layer)];"country"===t.layer.type&&("overlayadd"===t.type?p.addLayer(e[a]):p.removeLayer(e[a]))}))}(t.countries),s.addControl((a=new i.a.Control.Search({layer:p,propertyName:"name",circleLocation:!1,initial:!1,autoCollapse:!0,zoom:10}),a.on("search_locationfound",(function(t){return function(t){if(!p.hasLayer(t)||!t._icon&&!t.__parent._icon)return!1;p.zoomToShowLayer(t,(function(){t._popup&&t.openPopup()}))}(t.layer)})),a)),Promise.all(n.a.map(e,(function(t){return t.promise.then((function(t){return t.json()})).catch((function(t){return t}))}))).then((function(t){(function(t){var e=D("trip",t,{onEachFeature:S});0===h.length&&n.a.forEach(e,(function(t){return t.addTo(s)}));var a=L("trip",e);for(var r in y.trip=a,a._layers)a._layers[r]&&(g[i.a.Util.stamp(a._layers[r].layer)]=a._layers[r].name);s.on("overlayadd overlayremove",(function(e){var a=g[i.a.Util.stamp(e.layer)];if("trip"===e.layer.type){var r=t[a],o=n.a.map(r.properties.countries,"name");!function(t,e,a){for(var r=n.a.chain(t._layers).pick((function(t){return e.includes(t.layer.id)})).keys().value(),o=t._layerControlInputs,i=0,c=o.length;i<c;i++){var u=o[i];r.includes(String(u.layerId))&&(a&&u.checked||(a||u.checked)&&u.click())}}(y.country,o,"overlayadd"===e.type)}})),v.length>0&&(n.a.chain(e).filter((function(t){return!v.includes(t.id)})).forEach((function(t){s.removeLayer(t)})).value(),n.a.chain(e).filter((function(t){return v.includes(t.id)})).forEach((function(t){s.removeLayer(t),s.addLayer(t)})).value())})(e=n.a.chain(e).forEach((function(e,a){e.features=t[a]})).keyBy((function(t){return t.properties.name})).value()),y.other||(y.other=i.a.control.layers(null,null,{collapsed:!1}).addTo(s),y.other.addOverlay(p,"Markers"))}));var a}));var b=n.a.template('<strong><%- name %>, <%- _.startCase(country) %></strong> <small><%- type %></small><br><% if (!visited) { %><em>planning to visit</em><br><% } %><% if (typeof homebase !== "undefined" && homebase) { %><em>I used to live here</em><% } %><% if (typeof description !== "undefined") { %><span class="description"><%- description %></span><% } %>'),k=n.a.template("<strong><%- name %></strong> <small><%- type %></small><br>Distance: <%- Math.round(distance / 1000) %> km");function w(t,e){var a=b(t.properties);e.bindPopup(a)}function x(t,e){var a=t.properties.type.toLowerCase();t.properties.homebase?a="homebase":["national park","nature reserve"].includes(a)?a="park":d[a]||(a="visited");var r=d[a];return t.properties.visited||((r=n.a.clone(r)).color="#999"),i.a.marker(e,{icon:i.a.MakiMarkers.icon(r)})}function D(t,e,a){var r=n.a.chain(e).filter((function(t){return"Topology"!==t.features.type||t.features.arcs.length})).forEach((function(e){if("Topology"===e.features.type){var r=Object(c.a)(e.features,e.properties.id);e.layer=i.a.geoJson(r,a)}else e.layer=i.a.geoJson(e.features,a);e.layer.type=t,e.layer.id=e.properties.id})).keyBy((function(t){return t.properties.name})).value();return n.a.mapValues(r,"layer")}function L(t,e){var a=i.a.control.layers(null,e,{collapsed:!0}).addTo(s),r=a.getContainer();return i.a.DomUtil.addClass(r,"control-custom"),i.a.DomUtil.addClass(r,"control-"+t),i.a.Browser.touch?i.a.DomEvent.disableClickPropagation(r):i.a.DomEvent.disableClickPropagation(r).disableScrollPropagation(r),a}function S(t,e){var a=function(t){return f[t.properties.type.toLowerCase()]}(t);!function(t,e){var a;t.properties.distance=n.a.reduce((a=t.geometry.coordinates).slice(1).map((function(t,e){return[a[e],t]})),(function(t,e){return t+i.a.latLng(e[0][1],e[0][0]).distanceTo(i.a.latLng(e[1][1],e[1][0]))}),0);var r=k(t.properties);e.bindPopup(r)}(t,e),e.setStyle(a),e.on("mouseover",(function(){return e.setStyle(f.mouseover)})),e.on("mouseout",(function(){return e.setStyle(a)}))}var C=a("2VIQ"),T=a("6n/F"),_=a.n(T);function I(t){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var E=document.querySelectorAll(".expenditure-chart");E&&fetch("/expenditures.json").then((function(t){return t.json()})).then((function(t){var e=!0,a=!1,r=void 0;try{for(var o,i=function(){var e=o.value,a=e.dataset.chart,r={trip:e.dataset.trip,country:e.dataset.country,title:e.dataset.title,countryData:[]},i=n.a.chain(t.expenditures).filter("trip",r.trip).each((function(t){return r.countryData.push(t.countries)})).map("data").flatten().value();if(r.countryData=n.a.chain(r.countryData).flatten(r.countryData).filter((function(t){return t.dates.length>0})).value(),r.country&&(i=n.a.filter(i,"country",r.country),r.countryData=n.a.filter(r.countryData,"name",r.country)),0===r.countryData.length)return e.innerHTML="<p><em>No data available yet</em></p>",{v:void 0};O[a](e,i,r)},c=E[Symbol.iterator]();!(e=(o=c.next()).done);e=!0){var u=i();if("object"===I(u))return u.v}}catch(t){a=!0,r=t}finally{try{e||null==c.return||c.return()}finally{if(a)throw r}}document.addEventListener("click",(function(t){!P||t.target&&t.target.tooltipInitalizer||(Object(C.b)(),P=!1)}))}));var B,P=!1,M=["flight","boat","tour"],j=n.a.template('<table><tr><th>Date</th><th>Amount</th><th>Description</th></tr><% _.forEach(data, function (row) { %><tr><td><%- row.date %><td>$<%- row.amount %></td><td><%- row.description || "" %></td></tr><% }); %></table>'),z={},O={perTagCPD:function(t,e,a){var r=J(a.countryData);r=r[a.country];var o=n.a.chain(e).filter((function(t){return t.country===a.country})).groupBy("tags").map((function(t,e){var a=n.a.sumBy(t,(function(t){return parseInt(t.amount,10)}));return{name:e,y:a=Math.round(a/r*100)/100}})).value();_.a.chart(t,{chart:{type:"pie"},plotOptions:{pie:{allowPointSelect:!0,dataLabels:{enabled:!1},showInLegend:!0,events:{click:function(t){var a=t.point.name,r=n.a.filter(e,(function(t){return t.tags===a}));A(t.target,r)}}}},tooltip:{valuePrefix:"$",valueSuffix:"/day",pointFormat:"<b>{point.y} ({point.percentage:.1f}%)</b><br/>"},title:{text:a.title||""},series:[{name:"Tags",data:o}]})},perCountryCPD:function(t,e,a){var r=n.a.map(a.countryData,"name"),o=J(a.countryData);B=function(t){var e=n.a.now(),a=0;return n.a.chain(t).map("dates").flatten().each((function(t){var r=new Date(t.start),n=new Date(t.end);r<e&&(e=r),n>a&&(a=n)})).value(),{start:e,end:a}}(a.countryData);var i=n.a.chain(e).groupBy("tags").map((function(t,e){var a=n.a.fill(new Array(r.length),0),i=0;return n.a.chain(t).groupBy("country").each((function(t,e){var c=n.a.indexOf(r,e),u=o[e];if(u){var l=n.a.sumBy(t,(function(t){return parseInt(t.amount,10)}));i+=l,a[c]=l/u,a[c]=Math.round(100*a[c])/100}})).value(),z[e]=i,{name:e,visible:U(e),data:a}})).value();_.a.chart(t,{chart:{type:"bar",events:{redraw:function(){var t=(void 0).axes[1];t.removePlotLine("plot-average"),t.addPlotLine(q(t.series))}}},xAxis:{categories:r},yAxis:{min:0,title:{text:"Cost per day"},labels:{format:"${value}"},stackLabels:{enabled:!0,style:{color:"#999",fontWeight:"normal",textShadow:"none"}},plotLines:[q(i)]},legend:{reversed:!0},plotOptions:{series:{stacking:"normal"},bar:{events:{click:function(t){var a=t.point.category,r=this.name,o=n.a.filter(e,(function(t){return t.country===a&&t.tags===r}));A(t.target,o)}}}},tooltip:{valuePrefix:"$"},title:{text:a.title||""},series:i})}};function A(t,e){t.tooltipInitalizer=!0,Object(C.b)({exclude:t}),(t._tippy||Object(C.a)(t,{content:j({data:e}),trigger:"click"})).show(),P=!0}function U(t){return!M.includes(t)}function q(t){var e=(B.end-B.start)/1e3/3600/24+1;return{value:n.a.chain(t).filter("visible").reduce((function(t,e){return t+z[e.name]}),0).value()/e,color:"red",width:2,zIndex:20,id:"plot-average"}}function J(t){return n.a.chain(t).keyBy("name").mapValues((function(t){return n.a.reduce(t.dates,(function(t,e){var a=new Date(e.start);return t+(new Date(e.end)-a)/1e3/3600/24+1}),0)})).value()}var Y=document.querySelector("#commit-history");if(Y){var F=n.a.template('<li><a href="<%- html_url %>"><span class="date"><%- new Date(commit.author.date).toDateString() %></span> <%- commit.message %></li>');fetch("https://api.github.com/repos/oxyc/travels/commits").then((function(t){return t.json()})).then((function(t){var e=n.a.reduce(t,(function(t,e){return t+F(e)}),"");Y.innerHTML=e}))}}},[[0,1,2]]]);